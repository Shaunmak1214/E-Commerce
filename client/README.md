# Things the client-side has been built on
### Redux
- Redux forms the backbone for communicating with the rest API we have built on the back-end. 
- Whenever we need to get or post to our server we use **redux actions**.
- The response from the server is sent to the **redux reducer**. We receive this response as props in our components.
- All requests and responses are done in JSON format.
- There are mainly 4 states in our app : 
  - User - contains details of user and the signed in state
  - products - manages the entire product collection
  - Cart - contains all the info abt the user's cart
  - OrderHistory - contains the history of confirmed orders.
### Material UI
- Most of the material UI components have been integrated into this app. 
- A lot of styling to the material UI is provided by JSS (Css in JavaScript).
- You can refer to the [Material UI Documentation](https://material-ui.com/getting-started/usage/) for further explanation.
### Breakpoints
- CSS breakpoints are used all over the site to make it extremely responsive. 
 ```
  mb: "420px",
  sm: "640px",
  md: "768px",
  lg: "1024px",
  xl: "1280px",
```

# Structure
##### The project is well structured and organised for easy navigation.
#### The public folder contains our index.html. It contains a script provided by **Razor Pay** which is the payment gateway we use in our app.
### Src folder has all the components our app will use : 
- **Actions** contains the actions for redux store.
- **Assets** contains all the static files we use in different places.
- **Components** has those components which will be used everywhere in our app. 
- **hoc** are the higer order components which will wrap our app. Basically our app will be a child of these.
- **reducers** contains the different reducers for redux store.
- **styles** stores the main styles generated by tailwind CSS. Some components have their own styles as well. 
- **Widgets UI** contains all the re-useable components being used thoughout the app.

# HOCs
Higher order components are those which affect all routes in our app. They are never called from inside our code. Let's take a look at them.

## Layout
The layout is a functional higher order component. All our routes are passed as children to Layout which it then renders between a header and a footer.
```
<Layout>
  <Routes />
</Layout>
```

And our Layout returns this 
```
<Header />
  {props.children}
<Footer />
```
##### This structure gives the user a consistent feel while allowing him to navigate the website with utmost ease.

## Auth
The Auth hoc has just one job. To check with every route if the user has access or not. Every time we go to some link or refresh page, our component goes throuugh Auth HOC. 

**How it works**
- The Auth is a functional hoc. It receives the component we are about to render as a parameter.

- ```Auth(Composed Class, authUser, authAdmin)```

- As soon as some route is visited the Auth is called and an action is passed to redux store to get the auth details of the user. 
- The store sends a **GET** request to our server and receives a response with the details of the user if he is logged in or just an 

```{isAuth : false}```. 

- It then checks if the user is an admin or not. 
- Based on the above authorisation parameters it allows the user if he has access or redirects them to home page. In case the user is logged in but tried to access an admin route he is shown a Authorisation Revoked page.

##### The Auth hoc is the backbone of the security for our app and therefore very essential.

# Header
The Header handles a lot of functionalities - from logging in our user to navigating the whole site. I won't go much deep into logging in and sign up as thats mostly a part of the backend.

### Sidenav
- The sidenav is a part of Material UI's Sidenav Component.
- It's connected to the redux store to get the auth details of the user already stored in the user state of the store because of Auth hoc.
- There is a separate funcitonal component for sidenav items. This has three lists - no auth, user and for admin. 
- The sidenav items receives the auth details from sidenav and renders the list it deems fit.
- The Header passes sidenav props for toggling the log in and log out modals. 

### Forms 
- The forms have their own components. And they use the Input Widget which is custom made without the sue of material UI.
- The forms have been made to handle all kind of errors. All inputs are controlled.
- The inputs have their errors updated as they are filled in or blurred. 

#### Log In
- When the Log In form is submitted, it checks all the inputs for their errors.
- If they  all check out then the information is sent to the redux store which calls the log in api. 
- If the log in details match then we get a response like this 
```
isAuth : true,
id : user._id,
.
.
.
address : user.address
```
- If there is problem we get the appropriate response to display the error messages.

#### Sign Up
- Sign Up sends the user details to the server through an action through the redux store. 
- The server sends a mail regrading confirmation of the user.
- If mail is sent we receive `isAuth: false` as a response from the server. 
- If any error occurs we get appropriate response from the server.

### Cart
- The header is also connected by the cart state of redux. It only gets the number of items from the cart and displays it like a badge on the cart icon.

### The Header has a fixed position. The scrolling effect is done by adding a scroll event listener.

Also I have tried to make the header as responsive as possible. 

##### Creating a separate route for log in would have been more conveniant though.

# Home
The Home page is the first page as the site opens. As soon as the component is mounted a redux action is called to get a list of all the products from the database. Then a list of options is prepared which contains the titles and tags of the products. The first render then also sends another request to get 6 products based on the default filters. 

## The Home consists of a number of components
- Caraousel
- Search
- Products grid
- Filter

### Caraousel
This is a direct implementationn of the **React-Bootstrap Caraousel**. It renders 3 static images.

### Search
- This is a Widget which calls the autocomplete. Some custom JSS classes and the option list we prepared above is passed as props. This list is then alphabetically sorted for the user to easily find something they are looking for. 
- The search accepts an array of values which the user can enter by entering spaces or enter. 
- The search button sends this array and the other search filters to the redux store to get the filtered list of products. 
- The search bar is intended to always stay on the screen.
- The search is wrapped around a react-scrollmagic class which controls when the bar should go down or stay up. This changes according to the header appearing animation. 

### Product Grid
- The product grid is comprised of **Cards** from Material UI. The number of columns in the grid adjust with the screen width.
- The Card is another Widget that has the product images in a caraousel with the product details. 
- Each card has an action. Users can add the product to cart or the owners can directly edit the product.
- Each card is a link which takes the user to the product page.
- The *Add to cart* button sends as action to redux store with a the product Id which then sends the id to the server and we receive the new cart info in props as response.
- There is inifinite scrolling integrated into the home page. So more products load as the user scrolls to the bottom. 

This is done by adding a ref at the bottom of the page
```
<div ref={this.itemLoading}></div>
```
We initialize our scroll listner with scroll magic when the component has mounted
```
    new ScrollMagic.Scene({
      triggerElement: this.itemLoading.current,
      triggerHook: "onEnter",
    })
      .addTo(controller)
      .on("enter", () => this.handleOnScroll());
```
As soon as handleOnScroll is triggered a new request is sent to the server to get more products. We skip the origional item list but append the new items we get from the server in the actions with the already loaded list we pass as an argument to the redux action.
```
if (list) response.data.products = [...list, ...response.data.products];
      return response.data;
```

# Filter
The filter is a fixed position widget floating action button (FAB) from Material UI. It's got its own state by using React Hooks useState.
- The apply button verifies first if all the filters put by the user are valid and then sends the values to the Home and updates the main state.
- Then a redux action is sent with the updated filters which gets the new product list from the server.

# Dependencies

### Framework
- react
- react-dom
- react-router-dom
- react-redux
- react-router-navigation-prompt

### CSS 
- Material UI
- Tailwind CSS
- React-Bootstrap
- Material UI Chip Input
- Auto Prefixer
- PostCSS CLI
- PostCSS 
- RSuite
- Moment JS

### Animation
- React Transition Group
- React-Reveal
- Scroll Magic
- react-scroll-magic
- gsap

### Network and Requests
- axios
- HTTP-Proxy-Middleware
